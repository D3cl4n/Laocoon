import time

from Recon_Kernel import Recon_Kernel


def start_listener():  # rename
    # Get socket
    prompt = get_prompt(socket)
    recon = Recon_Kernel()
    kernel_version = recon.get_info(socket)
    payload = recon.parse(kernel_version)

    payload.local_command()
    payload.remote_command(payload)

    # Test if worked/interactive prompt/something


def send_command(socket, string, prompt):
    string = string.append("\n").encode("utf-8")
    socket.send(string)
    data = socket.recvuntil(prompt)
    return data


def get_prompt(socket):
    socket.send("\n")
    time.sleep(2)
    prompt = socket.recv(1024)
    prompt = prompt.split("\n")
    prompt = prompt[-1].strip()
    return prompt


